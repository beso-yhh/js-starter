{
  "version": 3,
  "sources": ["../bin/live-reload.js", "../node_modules/.pnpm/@finsweet+ts-utils@0.40.0/node_modules/@finsweet/ts-utils/dist/webflow/getPublishDate.js", "../src/utils/greet.ts", "../src/index.ts"],
  "sourcesContent": ["new EventSource(`${SERVE_ORIGIN}/esbuild`).addEventListener('change', () => location.reload());\n", "/**\n * Extracts the publish date of a Webflow site\n * @returns A Date object, if found.\n * @param page The page to get the publish date from. Defaults to the current page.\n */\nexport const getPublishDate = (page = document) => {\n    const publishDatePrefix = 'Last Published:';\n    for (const node of page.childNodes) {\n        if (node.nodeType === Node.COMMENT_NODE && node.textContent?.includes(publishDatePrefix)) {\n            const publishDateValue = node.textContent.trim().split(publishDatePrefix)[1];\n            if (publishDateValue)\n                return new Date(publishDateValue);\n        }\n    }\n};\n", "import { getPublishDate } from '@finsweet/ts-utils';\n\n/**\n * Greets the user by printing a message in the console.\n * @param name The user's name.\n */\nexport const greetUser = (name: string) => {\n  const publishDate = getPublishDate();\n\n  console.log(`Hello ${name}!`);\n  console.log(\n    `This site was last published on ${publishDate?.toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: '2-digit',\n    })}.`\n  );\n};\n", "import { greetUser } from '$utils/greet';\n\nimport type { Collection, CollectionProduct } from './cms/populate-external-data/types';\nimport type { CMSList } from './types/CMSList';\n\nwindow.Webflow ||= [];\nwindow.Webflow.push(async () => {\n  const name = 'John Do wewewewe';\n  greetUser(name);\n  // document.body.style.backgroundColor = 'blue';\n});\n\n/**\n * Populate CMS Data from an external API.\n */\n\n/**\n    1. Get Collection Products by Collection Id\n    2. Get Collections\n    3. Matching Collection Id with which one is belong to, for changing the header and description \n    4. Remove the Loader.\n */\nif (document.currentScript?.baseURI.toString().includes('category-details')) {\n  // console.log('document.currentScript?.baseURI = ' + document.currentScript?.baseURI);\n  const searchParams = new URLSearchParams(window.location.search);\n  const currentCollectionId = searchParams.get('collection');\n  window.fsAttributes = window.fsAttributes || [];\n  window.fsAttributes.push([\n    'cmsload',\n    async (listInstances: CMSList[]) => {\n      console.log(`Hello from the CMS`);\n\n      // Get the list instance\n      //const [listInstance] = listInstances;\n      const listInstance =\n        listInstances.find(({ wrapper }) => wrapper.id === 'products-cms-id') ?? listInstances[0];\n\n      // Save a copy of the template\n      const [firstItem] = listInstance.items;\n      const itemTemplateElement = firstItem.element;\n\n      // Fetch external data\n      const collectionProducts = await fetchCollectionProducts(Number(currentCollectionId)); // price_descending\n\n      // Remove existing items\n      listInstance.clearItems();\n\n      // Create the new items\n      await collectionProducts.map(async (collectionProduct) => {\n        itemTemplateElement.id = collectionProduct.id + '#becaby';\n        const item = createItem(collectionProduct, itemTemplateElement);\n        await listInstance.addItems([item]);\n        document\n          .getElementById(`${collectionProduct.id}#becaby`)\n          ?.addEventListener('click', function () {\n            window.open(\n              `https://becapy-new.webflow.io/product-details?product_id=${collectionProduct.id}`,\n              '_self'\n            );\n          });\n      });\n      // Populate the list\n      const collectionInstance =\n        listInstances.find(({ wrapper }) => wrapper.id === 'categories-cms-id') ?? listInstances[0];\n      const collections = await getCustomCategories();\n      console.log('collections[0].title = ' + collections[0].title);\n      const [firstCollectioItem] = collectionInstance.items;\n      const collectionItemTemplateElement = firstCollectioItem.element;\n      // Remove existing items\n      collectionInstance.clearItems();\n\n      // Create the new items\n      await collections.map(async (collection) => {\n        if (collection.id === Number(currentCollectionId)) {\n          if (document.getElementById('category-head-id') != null) {\n            document.getElementById('category-head-id')!.textContent =\n              collection.title.toUpperCase();\n          }\n          document.getElementById('category-description-id')!.innerHTML =\n            collection.body_html.toUpperCase();\n        }\n        collectionItemTemplateElement.id = collection.id + '#becaby';\n        const item = createCollectionItem(\n          collection,\n          collectionItemTemplateElement,\n          currentCollectionId!\n        );\n        await collectionInstance.addItems([item]);\n        document.getElementById(`${collection.id}#becaby`)?.addEventListener('click', function () {\n          window.open(\n            `https://becapy-new.webflow.io/category-details?collection=${collection.id}`,\n            '_self'\n          );\n        });\n      });\n      document.getElementById('loader-id')!.style.display = 'none';\n      window.Webflow.push(function () {\n        $('html').attr('data-wf-page', '65cdfd5f1054c1ba09309d71');\n        window.Webflow && window.Webflow.destroy();\n        window.Webflow && window.Webflow.ready();\n        window.Webflow && window.Webflow.require('ix2').init();\n        document.dispatchEvent(new Event('readystatechange'));\n      });\n    },\n  ]);\n}\n\n/**\n * Fetches fake products from Fake Store API.\n * @returns An array of {@link Product}.\n */\n// const fetchProducts = async (): Promise<Product[]> => {\n//   try {\n//     const response = await fetch('https://fakestoreapi.com/products');\n//     const data: Product[] = await response.json();\n\n//     return data;\n//   } catch (error) {\n//     return [];\n//   }\n// };\n\nconst fetchCollectionProducts = async (collectionId: number): Promise<CollectionProduct[]> => {\n  try {\n    const response = await fetch(\n      `https://getproductsbycollectionidhttps-dkhndz7lcq-uc.a.run.app/?collectionId=${collectionId}`\n    );\n    const data: CollectionProduct[] = await response.json();\n\n    return data;\n  } catch (error) {\n    return [];\n  }\n};\n\n/**\n * Creates an item from the template element.\n * @param product The product data to create the item from.\n * @param templateElement The template element.\n *\n * @returns A new Collection Item element.\n */\nconst createItem = (collectionProduct: CollectionProduct, templateElement: HTMLDivElement) => {\n  // Clone the template element\n  const newItem = templateElement.cloneNode(true) as HTMLDivElement;\n\n  // Query inner elements\n  const image = newItem.querySelector<HTMLImageElement>('[data-element=\"image\"]');\n  const title = newItem.querySelector<HTMLHeadingElement>('[data-element=\"title\"]');\n  const description = newItem.querySelector<HTMLParagraphElement>('[data-element=\"description\"]');\n  const price = newItem.querySelector<HTMLParagraphElement>('[data-element=\"price\"]');\n  console.log(collectionProduct.product.image);\n  // Populate inner elements\n  if (image && collectionProduct.product.image !== null)\n    image.src = collectionProduct.product.image.src;\n  if (title) title.textContent = collectionProduct.product.title;\n  if (description) description.innerHTML = collectionProduct.product.body_html;\n  if (price)\n    price.textContent =\n      collectionProduct.product.variants.length === 0\n        ? '-'\n        : collectionProduct.product.variants[0].price + ' AED';\n\n  return newItem;\n};\n\nconst createCollectionItem = (\n  collection: Collection,\n  templateElement: HTMLDivElement,\n  collectioId: string\n) => {\n  // Clone the template element\n  const newItem = templateElement.cloneNode(true) as HTMLDivElement;\n\n  // Query inner elements\n  const title = newItem.querySelector<HTMLHeadingElement>('[data-element=\"collection_title\"]');\n\n  // Populate inner elements\n  if (title) title.textContent = collection.title;\n  if (collection.id === Number(collectioId)) {\n    title!.style.fontWeight = 'bold';\n    title!.style.color = 'black';\n  }\n\n  return newItem;\n};\n\nfunction getSyncScriptParams() {\n  console.log('document.currentScript = ' + document.currentScript?.baseURI);\n  const name = document.getElementById('helper')?.getAttribute('current_collection');\n  console.log('name = ' + name);\n  if (document.currentScript?.baseURI.toString().includes('category-details')) {\n    console.log('TTT');\n    isCollection = true;\n  }\n}\n\nconst getCustomCategories = async (): Promise<Collection[]> => {\n  try {\n    let data: Collection[] = [];\n    await fetch('https://getcustomcollections-dkhndz7lcq-uc.a.run.app').then(async (result) => {\n      data = (await result.json())['custom_collections'];\n      console.log(data[0].id);\n      return data;\n    });\n\n    return data;\n  } catch (error) {\n    return [];\n  }\n};\n"],
  "mappings": "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",
  "names": []
}
